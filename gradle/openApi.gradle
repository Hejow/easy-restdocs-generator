openapi3 {
    server = 'localhost:8080'
    title = 'simple-restdocs-generator'
    description = 'simple swagger'
    version = '0.0.1'
    outputFileNamePrefix = 'simple-api-spec'
}

var swaggerSource = toDirectory("api-spec/${openapi3.outputFileNamePrefix}.${openapi3.format}").asFile
var duplicateInto = toDirectory("resources/main/static/docs")

swaggerSources {
    simple {
        setInputFile(swaggerSource)
    }
}

tasks.withType(project.GenerateSwaggerUI).configureEach {
    dependsOn ':openapi3'
}

tasks.register("duplicateSwaggerUiIntoJar", Copy) {
    group 'custom'
    description 'duplicate Swagger UI which generated by task into jar'

    dependsOn ':generateSwaggerUISimple'
    from "${generateSwaggerUISimple.outputDir}"
    into duplicateInto

    tasks.resolveMainClassName.mustRunAfter ':duplicateSwaggerUiIntoJar'
}

bootJar {
    dependsOn ':duplicateSwaggerUiIntoJar'
}

def toDirectory(String path) {
    return layout.buildDirectory.dir(path).get()
}
